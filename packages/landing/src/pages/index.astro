---
import { getImage } from "astro:assets";
import { Hero } from "../components/landing/Hero";
import { ChatSection } from "../components/landing/ChatSection";
import Layout from "../layouts/Layout.astro";
import {
  Code,
  Search,
  Sparkles,
  Zap,
  Shield,
  Globe,
  ChevronRight,
  Share2,
} from "lucide-react";
import { Container } from "../components/Container";

// Import images for optimization
import screenshotSidebar from "../../public/screenshot_sidebar.png";
import screenshotChat from "../../public/screenshot_document_chat.png";

// Generate optimized images for Hero
const heroWidths = [400, 640, 980, 1280, 1920];
const heroOptimizedImages = await Promise.all(
  heroWidths.map((width) =>
    getImage({
      src: screenshotSidebar,
      width,
      format: "webp",
      quality: 85,
    })
  )
);
const heroSrcset = heroOptimizedImages
  .map((img) => `${img.src} ${img.options.width}w`)
  .join(", ");
const heroDefaultImage = heroOptimizedImages[heroOptimizedImages.length - 1];

// Generate optimized images for ChatSection
const chatWidths = [400, 640, 980, 1280, 1920];
const chatOptimizedImages = await Promise.all(
  chatWidths.map((width) =>
    getImage({
      src: screenshotChat,
      width,
      format: "webp",
      quality: 100,
    })
  )
);
const chatSrcset = chatOptimizedImages
  .map((img) => `${img.src} ${img.options.width}w`)
  .join(", ");
const chatDefaultImage = chatOptimizedImages[chatOptimizedImages.length - 1];

const keyBenefits = [
  {
    title: "Find information instantly",
    description: "Search across all your documents with AI-powered search.",
    icon: Search,
  },
  {
    title: "Collaborate in real-time",
    description: "Stay in sync with your team or across devices with ease.",
    icon: Share2,
  },
  {
    title: "Open-source",
    description:
      "Free to use, modify, and contribute. No hidden fees or vendor lock-in.",
    icon: Globe,
  },
];

const howItWorks = [
  {
    step: "1",
    title: "Create or import your documents",
    description:
      "Start writing or bring in existing content. Lydie works with any text format.",
  },
  {
    step: "2",
    title: "Chat with AI to get suggestions",
    description:
      "Ask questions, request edits, or get writing help. The AI understands your entire workspace.",
  },
  {
    step: "3",
    title: "Review and accept changes",
    description:
      "See every suggestion before it's applied. You decide what stays and what goes.",
  },
];

const productFeatures = [
  {
    title: "AI-powered search",
    description:
      "Find information across all your documents instantly, even if you don't remember exact words.",
    icon: Search,
  },
  {
    title: "Context-aware editing",
    description:
      "Get suggestions that understand your writing style and document structure.",
    icon: Sparkles,
  },
  {
    title: "API access",
    description:
      "Automate workflows and integrate Lydie into your existing tools and processes.",
    icon: Code,
  },
  {
    title: "Open-source",
    description:
      "Free to use, modify, and contribute. No hidden fees or vendor lock-in.",
    icon: Globe,
  },
];
---

<Layout
  title="Lydie"
  description="A minimal, powerful writing environment supercharged with AI."
>
  <div class="flex flex-col gap-y-16 overflow-hidden">
    <Hero
      client:load
      imageSrc={heroDefaultImage.src}
      imageSrcSet={heroSrcset}
      imageSizes="(max-width: 768px) 100vw, 980px"
      imageAlt="Screenshot of the the Lydie platform including a sidebar with a document tree as well as the main WYSIWYG editor focusing on a document titled 'The Enduring Allure of Coffee'."
      imageWidth={heroDefaultImage.options.width}
      imageHeight={heroDefaultImage.options.height}
    />

    <!-- Key Benefits -->
    <Container className="flex flex-col gap-y-12 relative">
      <div class="grid md:grid-cols-3 grid-cols-1 gap-6">
        {
          keyBenefits.map((benefit) => (
            <div class="flex flex-col gap-y-2">
              <div class="flex items-center gap-x-2">
                <benefit.icon className="size-4 text-gray-700" />
                <span class="font-medium text-[15px]/0 text-gray-900">
                  {benefit.title}
                </span>
              </div>
              <p class="text-sm text-gray-600 leading-relaxed">
                {benefit.description}
              </p>
            </div>
          ))
        }
      </div>
      <hr class="border-gray-100 w-full max-w-5xl mx-auto" />
    </Container>
    <ChatSection
      client:load
      imageSrc={chatDefaultImage.src}
      imageSrcSet={chatSrcset}
      imageSizes="(max-width: 768px) 100vw, 980px"
      imageAlt="Screenshot showing AI chat interface with document editing suggestions"
      imageWidth={chatDefaultImage.options.width}
      imageHeight={chatDefaultImage.options.height}
    />
    <!-- <Container className="flex flex-col gap-y-8 relative">
      <div class="flex flex-col gap-y-2 text-center mb-8">
        <h2
          class="text-3xl font-heading font-medium tracking-tight text-gray-900"
        >
          Everything you need to write better
        </h2>
        <p class="text-[15px] text-gray-600 max-w-2xl mx-auto">
          Powerful features that help you focus on what matters: your writing.
        </p>
      </div>
      <div class="grid md:grid-cols-2 gap-6 max-w-4xl mx-auto">
        {
          productFeatures.map((feature) => (
            <div class="flex gap-x-4">
              <div class="shrink-0">
                <feature.icon className="size-5 text-gray-700 mt-0.5" />
              </div>
              <div class="flex flex-col gap-y-1">
                <h3 class="font-medium text-[15px]/0 text-gray-900">
                  {feature.title}
                </h3>
                <p class="text-sm text-gray-600 leading-relaxed">
                  {feature.description}
                </p>
              </div>
            </div>
          ))
        }
      </div>
      <div class="flex flex-col gap-y-3 text-center max-w-3xl mx-auto mt-6">
        <p class="text-[15px]/relaxed text-gray-600">
          Lydie is still early and we're shipping new capabilities every week.
          See what’s live today, what’s up next, and help shape the roadmap.
        </p>
        <div class="flex justify-center">
          <Button href="/roadmap" intent="secondary">
            Explore the roadmap
          </Button>
        </div>
      </div>
      <hr class="border-gray-100 w-full max-w-5xl mx-auto mt-8" />
    </Container> -->
    <Container className="flex flex-col gap-y-6 relative pb-16">
      <div class="flex flex-col gap-y-4 text-center max-w-2xl mx-auto">
        <h2
          class="text-3xl font-heading font-medium tracking-tight text-gray-900"
        >
          Start writing smarter today
        </h2>
        <p class="text-[15px] text-gray-600">
          Start writing better, faster with AI that understands your work.
        </p>
        {
          /* <div class="flex justify-center mt-4">
          <Button href="https://app.lydie.co/auth" size="lg">
            <div class="flex items-center gap-x-1">
              <span>Try Lydie free</span>
              <ChevronRight
                className="size-3.5 translate-y-px group-hover:translate-x-0.5 transition-transform duration-200"
              />
            </div>
          </Button>
        </div> */
        }
      </div>
    </Container>

    <!-- <ApiSection /> -->
    <!-- <hr class="border-gray-100 w-full max-w-5xl mx-auto relative" /> -->
    <!-- <AssistantSection client:load /> -->
    <script>
      // import { authClient } from "../utils/auth";

      // // Check if user is logged in and redirect to app
      // authClient.getSession().then((response) => {
      //   console.log(response);
      //   if (response.data) {
      //     // User is logged in, redirect to the main app
      //     window.location.href = import.meta.env.PUBLIC_VITE_API_URL.includes(
      //       "localhost"
      //     )
      //       ? "http://localhost:3000"
      //       : "https://app.lydie.co";
      //   }
      // });
    </script>
  </div>
</Layout>
