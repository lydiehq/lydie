---
import { getImage } from "astro:assets";
import { Hero } from "./Hero";
import { ChatSection } from "./ChatSection";
import {
  Search,
  Globe,
  ChevronRight,
  Share2,
} from "lucide-react";
import { Container } from "../Container";
import screenshotSidebar from "../../../public/screenshot_sidebar.png";
import screenshotChat from "../../../public/screenshot_document_chat.png";
import { Button } from "../generic/Button";

// Generate optimized images for Hero
const heroWidths = [400, 640, 980, 1280, 1920];
const heroOptimizedImages = await Promise.all(
  heroWidths.map((width) =>
    getImage({
      src: screenshotSidebar,
      width,
      format: "webp",
      quality: 85,
    })
  )
);
const heroSrcset = heroOptimizedImages
  .map((img) => `${img.src} ${img.options.width}w`)
  .join(", ");
const heroDefaultImage = heroOptimizedImages[heroOptimizedImages.length - 1];

// Generate optimized images for ChatSection
const chatWidths = [400, 640, 980, 1280, 1920];
const chatOptimizedImages = await Promise.all(
  chatWidths.map((width) =>
    getImage({
      src: screenshotChat,
      width,
      format: "webp",
      quality: 100,
    })
  )
);
const chatSrcset = chatOptimizedImages
  .map((img) => `${img.src} ${img.options.width}w`)
  .join(", ");
const chatDefaultImage = chatOptimizedImages[chatOptimizedImages.length - 1];

const keyBenefits = [
  {
    title: "Find information instantly",
    description: "Search across all your documents with AI-powered search.",
    icon: Search,
  },
  {
    title: "Collaborate in real-time",
    description: "Stay in sync with your team or across devices with ease.",
    icon: Share2,
  },
  {
    title: "Open-source",
    description:
      "Free to use, modify, and contribute. No hidden fees or vendor lock-in.",
    icon: Globe,
  },
];
---

<div class="flex flex-col gap-y-16 overflow-hidden">
  <Hero
    client:load
    imageSrc={heroDefaultImage.src}
    imageSrcSet={heroSrcset}
    imageSizes="(max-width: 768px) 100vw, 980px"
    imageAlt="Screenshot of the the Lydie platform including a sidebar with a document tree as well as the main WYSIWYG editor focusing on a document titled 'The Enduring Allure of Coffee'."
    imageWidth={heroDefaultImage.options.width}
    imageHeight={heroDefaultImage.options.height}
  />

  <!-- Key Benefits -->
  <Container className="flex flex-col gap-y-12 relative">
    <div class="grid md:grid-cols-3 grid-cols-1 gap-6">
      {
        keyBenefits.map((benefit) => (
          <div class="flex flex-col gap-y-2">
            <div class="flex items-center gap-x-2">
              <benefit.icon className="size-4 text-gray-700" />
              <span class="font-medium text-[15px]/0 text-gray-900">
                {benefit.title}
              </span>
            </div>
            <p class="text-sm text-gray-600 leading-relaxed">
              {benefit.description}
            </p>
          </div>
        ))
      }
    </div>
    <hr class="border-gray-100 w-full max-w-5xl mx-auto" />
  </Container>
  <ChatSection
    client:load
    imageSrc={chatDefaultImage.src}
    imageSrcSet={chatSrcset}
    imageSizes="(max-width: 768px) 100vw, 980px"
    imageAlt="Screenshot showing AI chat interface with document editing suggestions"
    imageWidth={chatDefaultImage.options.width}
    imageHeight={chatDefaultImage.options.height}
  />
  <Container className="flex flex-col gap-y-6 relative pb-16">
    <div class="flex flex-col gap-y-4 text-center max-w-2xl mx-auto">
      <h2
        class="text-3xl font-heading font-medium tracking-tight text-gray-900"
      >
        Start writing smarter today
      </h2>
      <p class="text-[15px] text-gray-600">
        Start writing better, faster with AI that understands your work.
      </p>
      <div class="flex justify-center mt-4">
        <Button href="https://app.lydie.co/auth" size="lg">
          <div class="flex items-center gap-x-1">
            <span>Try Lydie free</span>
            <ChevronRight
              className="size-3.5 translate-y-px group-hover:translate-x-0.5 transition-transform duration-200"
            />
          </div>
        </Button>
      </div>
    </div>
  </Container>
</div>
