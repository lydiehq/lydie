---
import { CastShadow } from "../generic/CastShadow";

const {
  label,
  width = "normal",
  isHighlighted = false,
  className,
  /** Rotation in degrees, applied to the key cap inside the shadow (shadow stays fixed). */
  rotate = 0,
} = Astro.props;

const widthClasses: Record<string, string> = {
  normal: "w-[60px]",
  wide: "w-[70px]",
  xwide: "w-[90px]",
  cmd: "w-[70px]",
  space: "w-[340px]",
  fn: "w-[50px]",
  shift: "w-[110px]",
};

const baseClasses = [
  "relative h-[60px] ring-black/5 ring rounded-xl shadow-legit flex items-center justify-center text-[12px] font-semibold select-none transition-all duration-200 flex-shrink-0 shadow-sm relative",
  "",
  widthClasses[width] || widthClasses.normal,
  isHighlighted
    ? "bg-gradient-to-b from-[#3b82f6] to-[#2563eb] text-white border-[#1d4ed8] border-t-blue-400 "
    : "text-black/60 bg-linear-to-t from-gray-200 to-gray-100",
  className,
].join(" ");
---

<CastShadow
  className="w-full"
  height={10}
  strength={1}
  borderRadius={20}
  lightAngle={145 + rotate}
  style={rotate !== 0 ? { transform: `rotate(${rotate}deg)` } : undefined}
>
  <div class={baseClasses}>
    <div
      class={`absolute inset-1.5 rounded-lg ring ring-black/3 ${isHighlighted ? "bg-blue-400" : "bg-white"}`}
    >
    </div>
    <span class="relative z-10">{label}</span>
    {
      isHighlighted && (
        <div class="absolute inset-0 rounded-md bg-blue-400/20 animate-pulse" />
      )
    }
  </div>
</CastShadow>
