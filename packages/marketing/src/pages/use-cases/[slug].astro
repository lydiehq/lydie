---
import Layout from "../../layouts/Layout.astro";
import Container from "../../components/Container.astro";
import Breadcrumbs from "../../components/Breadcrumbs.astro";
import { Button } from "../../components/generic/Button";
import { ChevronRightRegular } from "@fluentui/react-icons";
import { FAQSection } from "src/components/tools/FAQSection";
import { GradientOutline } from "src/components/generic/GradientOutline";
import { DemoWithSelector } from "../../components/landing/DemoWithSelector";
import Divider from "src/components/landing/Divider.astro";
import "../../styles/grainy-gradient.css";
import { CTASection } from "src/components/landing/CTASection";
import { Heading } from "src/components/generic/Heading";
import { getUseCase, useCases, type UseCase } from "src/data/use-cases";

export function getStaticPaths() {
  return useCases.map((useCase) => ({
    params: { slug: useCase.slug },
  }));
}

const { slug } = Astro.params;
const useCase: UseCase | undefined = getUseCase(slug!);

if (!useCase) {
  return Astro.redirect("/404");
}

const {
  metaTitle,
  metaDescription,
  title,
  description,
  content,
  faqs,
  demoStates,
  ctaText,
} = useCase;
---

<Layout title={metaTitle} description={metaDescription}>
  <div class="max-w-4xl relative">
    <!-- 768px internal width, centered (w-1 = 4px each side) -->
    <div
      class="fixed inset-y-0 w-1 border-r border-black/4"
      style="left: calc(50% - 388px)"
    >
    </div>
    <div
      class="fixed inset-y-0 w-1 border-r border-black/4"
      style="right: calc(50% - 388px)"
    >
    </div>
  </div>
  <Container
    className="flex flex-col items-center justify-center min-h-[60vh] py-8 gap-y-12"
  >
    <div class="w-full">
      <Breadcrumbs
        items={[{ label: "Use cases", href: "/use-cases" }, { label: title }]}
      />
    </div>
    <div class="text-center relative py-8 size-full">
      <div
        class="flex flex-col max-w-md mx-auto text-center items-center gap-y-6"
      >
        <Heading className="text-4xl">
          {metaTitle.replace(" - Lydie", "")}
        </Heading>
        <p class="text-base text-black/60 mx-auto text-balance">
          {description}
        </p>
        <div class="flex items-center justify-center gap-4">
          <Button href="https://app.lydie.co/auth" size="lg" intent="primary">
            <span>{ctaText}</span>
            <ChevronRightRegular className="size-4" />
          </Button>
        </div>
      </div>
    </div>
    <DemoWithSelector
      client:load
      states={demoStates}
      initialState={demoStates[0]}
    />
    <div class="max-w-xl mx-auto flex flex-col gap-y-8">
      <div class="prose mx-auto">
        {
          content.map((paragraph: string, index: number) => (
            <p
              class="fade-in-element"
              style={`animation-delay: ${0.4 + index * 0.1}s;`}
            >
              {paragraph}
            </p>
          ))
        }
      </div>
      <Divider />
      <FAQSection faqs={faqs} client:load />
    </div>
  </Container>
  <CTASection client:load />
</Layout>

<style>
  @keyframes fade-in-up {
    0% {
      opacity: 0;
      transform: translateY(10px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .fade-in-element {
    animation: fade-in-up 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    opacity: 0;
  }
</style>
